<ng-container *ngIf="hieHwrFeatureFlag">
<div class="container-fluid py-4">
  <div class="practitioner-search-layout">
    <div class="row">
      <div class="col-md-12">
        <div class="card shadow-sm mb-4">
          <div class="card-header bg-light py-3 d-flex align-items-center">
            <h3 class="card-title mb-0">
              <i class="fa fa-search me-2"></i> Health Worker Search
            </h3>
          </div>
          <div class="card-body p-4">
            <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
              <div class="row">
                <div class="col-md-2 col-sm-6 col-xs-12">
                  <div class="form-group">
                    <label for="searchType" class="control-label"
                      >Search By</label
                    >
                    <select
                      class="form-control"
                      id="searchType"
                      formControlName="searchType"
                    >
                      <option value="NATIONAL_ID">National ID</option>
                      <option value="REGISTRATION_NUMBER">
                        Registration No
                      </option>
                      <option value="LICENSE_NO">License No</option>
                    </select>
                  </div>
                </div>

                <div class="col-md-3 col-sm-6 col-xs-12">
                  <div class="form-group">
                    <label for="searchValue" class="control-label"
                      >Search Value</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="searchValue"
                      placeholder="Enter search value"
                      formControlName="searchValue"
                    />
                  </div>
                </div>

                <div class="col-md-2 col-sm-4 col-xs-12">
                  <div class="form-group">
                    <label class="control-label">&nbsp;</label>
                    <button
                      type="submit"
                      class="btn btn-primary btn-block"
                      [disabled]="isLoading"
                    >
                      <i class="fa fa-search fa-fw"></i> Search
                    </button>
                  </div>
                </div>

                <div class="col-md-3 col-sm-4 col-xs-12">
                  <div class="form-group">
                    <label class="control-label">&nbsp;</label>
                    <button
                      type="button"
                      class="btn btn-success btn-block"
                      (click)="getAllProviders()"
                      [disabled]="isLoading"
                    >
                      <i class="fa fa-users fa-fw"></i> Get All Providers
                    </button>
                  </div>
                </div>

                <div class="col-md-2 col-sm-4 col-xs-12">
                  <div class="form-group">
                    <label class="control-label">&nbsp;</label>
                    <button
                      type="button"
                      class="btn btn-danger btn-block"
                      (click)="onReset()"
                      [disabled]="isLoading"
                    >
                      <i class="fas fa-redo"></i> Reset
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>

        <div class="card shadow-sm">
          <div class="card-header bg-light py-3 d-flex align-items-center">
            <i class="fas fa-hospital-user me-2 text-primary"></i>
            <h3 class="card-title mb-0">Providers</h3>
            <span class="badge bg-secondary ms-2">{{ providers.length }}</span>
          </div>
          <div class="card-body p-4">
            <div *ngIf="isLoading" class="text-center p-5">
              <div
                class="spinner-border text-primary"
                style="width: 3rem; height: 3rem"
                role="status"
              >
                <span class="visually-hidden">Loading...</span>
              </div>
              <p class="mt-3 text-muted">Loading providers...</p>
            </div>

            <div
              *ngIf="!isLoading && providers.length === 0"
              class="text-center p-5"
            >
              <i class="fas fa-hospital-user fa-3x text-muted mb-3"></i>
              <p class="text-muted fs-5">
                {{
                  searchPerformed
                    ? 'No providers found matching your criteria.'
                    : 'No providers available. Click "Get All Providers" to load facility providers.'
                }}
              </p>
            </div>

            <div *ngIf="!isLoading && providers.length > 0">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title">Providers List</h4>
                </div>
                <div class="table-responsive">
                  <table class="table table-striped table-bordered table-hover">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Provider Name</th>
                        <th>National ID</th>
                        <th>Location</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let provider of providers; let i = index">
                        <td>{{ i + 1 }}</td>
                        <td>{{ provider.provider_names }}</td>
                        <td>{{ provider.national_id }}</td>
                        <td>{{ provider.location_name }}</td>
                        <td>
                          <button
                            class="btn btn-sm px-3 btn-info"
                            (click)="viewProviderDetails(provider)"
                          >
                            <i class="fas fa-eye"></i> View Details
                          </button>
                        </td>
                      </tr>

                      <tr *ngIf="providers.length === 0 && !isLoading">
                        <td colspan="5" class="text-center text-muted">
                          No providers found
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="errorMessage" class="alert alert-danger mt-4" role="alert">
          {{ errorMessage }}
        </div>
      </div>
      <app-practitioner-detail-modal
        [practitioner]="selectedPractitioner"
        [isVisible]="showModal"
        (closeModal)="closeModal()"
      >
      </app-practitioner-detail-modal>
    </div>
  </div>
</div>
</ng-container>
