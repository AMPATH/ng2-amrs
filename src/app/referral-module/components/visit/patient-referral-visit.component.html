<div class="patient-referral-visit">
  <div style="margin-top: 4px; margin-bottom: 4px;">
    <span *ngIf="program" style="color: gray;">
        Patient was referred for <strong>{{program.display}}</strong>
      at <strong>{{ program.location.display }}</strong>
      on <strong>{{ program.dateEnrolled }}</strong>. <span *ngIf="currentWorkflow">The current workflow is <strong>{{currentWorkflow?.concept.display}}</strong> with state of <strong>{{currentWorkflowState.concept.display}}</strong> </span>
    </span><a (click)="changeState()" href="javascript:void(0)">Change</a>
  </div>
  <p-dialog styleClass="referral-dialog" header="Patient State" width="80%" [(visible)]="display" modal="true" appendTo="body">
    <div class="item-container" style="position: relative;">
      <div [ngBusy]="{busy:[isUpdating],message:'Updating...'}"></div>
      <div class="col-md-8 col-xs-8 col-sm-8" style="padding-left:0;">
        <label>Select a state to update</label>
        <select name="workFlowState" class="form-control" [(ngModel)]="selectedWorkFlowState"
                (ngModelChange)="getWorkFlowState($event)">
          <option *ngFor="let state of workflowStates" [ngValue]="state">
            {{state.concept.display}}
          </option>
        </select>
      </div>
      <div class="col-md-4 col-xs-4 col-sm-4">
        <label>&nbsp;</label>
        <div *ngIf="showButton" class="button-submit">
          <button class="btn btn-primary" (click)="updateEnrollmentState()">Update</button>
        </div>
      </div>
      <div style="clear: both;"></div>
    </div>
  </p-dialog>
</div>

